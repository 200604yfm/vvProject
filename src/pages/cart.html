<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    
    <link rel="stylesheet" href="../lib/swiper/css/swiper.min.css">

    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/cart.css">
    <link rel="stylesheet" href="../font/iconfont.css">
    <!-- <link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.min.css"> -->
    
</head>
<body>
    <!-- 头部 -->
    <div id="headerBox">
        <div class="header">
            <ul class="headerLeft">
                <li><a href="#">品牌</a></li>
                <li><a href="#">Funtouch OS</a></li>
                <li><a href="#">体验店</a></li>
                <li><a href="#">企业业务</a></li>
                <li><a href="#">社区</a></li>
            </ul>
            <ul class="headerRight">
                <li><a href="#">购物车</a></li>
                <li><a href="#">登录</a></li>
                <li><a href="#">注册</a></li>
            </ul>
        </div>
    </div>

    <!-- 导航 -->
    <div id="wrap-nav">
        <div class="nav">
            <h1><a href="./index.html"><img src="../images/logoBlack.png" alt=""></a></h1>
            <ul>
                <li><a href="#">NEX系列</a></li>
                <li><a href="#">X系列</a></li>
                <li><a href="#">S系列</a></li>
                <li><a href="#">Y系列</a></li>
                <li><a href="#">Z系列</a></li>
                <li><a href="#">U系列</a></li>
                <li><a href="#">IQOO手机</a></li>
                <li><a href="#">真无限耳机</a></li>
                <li class="active"><a href="#">商城</a></li>
                <li><a href="#">服务</a></li>
            </ul>
            <span class="iconfont icon-search-line"></span>
        </div>
    </div>

    <!-- 主体部分 -->
    <div id="wrap-cart">
        <div class="cartTitle" >
            <h2>我的购物车</h2>
            <a href="#">继续购物 > </a>
        </div>
    </div>

    <div id="main-cart">
        <div class="cartBox" >

            <table>
                <tr>
                    <th>商品名称</th>
                    <th>价格（元）</th>
                    <th>数量</th>
                    <th>小计（元）</th>
                    <th>操作</th>
                </tr>
                <tr id="itemList">
                    <td>
                        <a href="./details.html">
                            <img src="../images/detailsImg-S1.png" alt="">
                        </a>
                        <div>
                            <a href="./details.html">iQOO 影音耳机 极速黄</a>
                            
                        </div>
                    </td>

                    <td class="originPrice">
                        125.00
                    </td>
                    <td>
                        <li class="cutNum">-</li>
                        <li class="amount">1</li>
                        <li class="addNum">+</li>
                    </td>
                    <td class="totalPrice">125.00</td>
                    <td id="delItem">删除</td>
                </tr>
            </table>
            
        </div>
    </div>


    <!-- 底部 -->
    <div id="wrap-footer">
        <div id="main-footer">
            
            <div id="footer-1f">
                <li>
                    <span class="iconfont icon-zhengpinbaozhang2"></span> 
                    官方正品
                </li>
                <li>
                    <span class="iconfont icon-zhengfangti"></span> 
                    顺丰极速达
                </li>
                <li>
                    <span class="iconfont icon-aixin"></span> 
                    全国联保
                </li>
                <li>
                    <span class="iconfont icon-shanguangdeng"></span>
                    镭雕定制
                </li>
            </div>

            <div id="footer-2f">
                <ul id="footer-2f-left">
                    <li>
                        <dl>
                            <dt>热门链接</dt>
                            <dd><a href="#">X50 Pro</a></dd>
                            <dd><a href="#">NEX 3S</a></dd>
                            <dd><a href="#">Z6</a></dd>
                            <dd><a href="#">vivo摄影</a></dd>
                            <dd><a href="#">查找手机</a></dd>
                            <dd><a href="#">常见问题</a></dd>
                        </dl>
                    </li>
                    <li>
                        <dl>
                            <dt>在线购买</dt>
                            <dd><a href="#">官方商城</a></dd>
                            <dd><a href="#">选购手机</a></dd>
                            <dd><a href="#">选购配件</a></dd>
                            <dd><a href="#">企业服务</a></dd>
                            <dd><a href="#">以旧换新</a></dd>
                            <dd><a href="#">保障服务</a></dd>
                        </dl>
                    </li>
                    <li>
                        <dl>
                            <dt>服务支持</dt>
                            <dd><a href="#">服务首页</a></dd>
                            <dd><a href="#">服务网点查询</a></dd>
                            <dd><a href="#">真伪查询</a></dd>
                            <dd><a href="#">预约维修</a></dd>
                            <dd><a href="#">维修配件价格</a></dd>
                            <dd><a href="#">服务政策</a></dd>
                            <dd><a href="#">安全公告</a></dd>
                        </dl>
                    </li>
                    <li>
                        <dl>
                            <dt>vivo社区</dt>
                            <dd><a href="#">社区首页</a></dd>
                            <dd><a href="#">摄影专区</a></dd>
                            <dd><a href="#">微博</a></dd>
                            <dd><a href="#">贴吧</a></dd>
                            <dd><a href="#">兴趣部落</a></dd>
                        </dl>
                    </li>
                    <li>
                        <dl>
                            <dt>关于vivo</dt>
                            <dd><a href="#">vivo简介</a></dd>
                            <dd><a href="#">工作机会</a></dd>
                            <dd><a href="#">新闻资讯</a></dd>
                            <dd><a href="#">采购平台</a></dd>
                            <dd><a href="#">供应商协同平台</a></dd>
                            <dd><a href="#">开放平台</a></dd>
                        </dl>
                    </li>
                </ul>

                <div id="footer-2f-right">
                    <div class="online-server">
                        <a href="#">
                            <span class="iconfont icon-liuyan"></span>
                            在线客服
                        </a>
                    </div>
                    <div class="phone-box">
                        <h2>400-678-9688</h2>
                        <h3>全国客户服务热线 7*24小时</h3>
                    </div>
                    <div class="phone-box">
                        <h2>400-678-9688</h2>
                        <h3>NEX 专属服务热线 7*24小时</h3>
                    </div>
                    <div class="follow">
                        关注vivo
                        <p>
                            <span class="iconfont icon-weibo"></span>
                            <span class="iconfont icon-weixin"></span>
                            <span class="iconfont icon-zhifubao"></span>
                            <span class="iconfont icon-lianjie"></span>
                        </p>
                    </div>
                </div>
            </div>

            <div id="footer-3f">
                <li>Copyright ©2011-2020 广东天宸网络科技有限公司 版权所有 保留一切权利</li>
                <li><a href="#">隐私政策</a></li>
                <li><a href="#">法律声明</a></li>
                <li><a href="#">营业执照</a></li>
                <li><a href="#">粤B2-20080267</a></li>
                <li><a href="#">粤ICP备14052990</a></li>
                <li>
                    <a href="#">
                        <span class="iconfont icon-gongan"></span>
                        粤公网安备 44190002004246号
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="iconfont icon-quanqiu"></span>
                        Select Location
                    </a>
                </li>
            </div>
        </div>
    </div>

    <!-- 右侧固定栏 -->
    <div id="rightFixbox">
        <li>
            <span class="iconfont icon-gouwuche"></span>
            <p>购物车</p>
        </li>
        <li>
            <span class="iconfont icon-xingzhuang"></span>
            <p>小v客服</p>
        </li>
        <li>
            <span class="iconfont icon-wenhao"></span>
            <p>帮助中心</p>
        </li>
        <li class="toTop">
            <span class="iconfont icon-huidaodingbu"></span>
            <p>返回顶部</p>
        </li>
    </div>


    <!-- js -->
    <script src="../lib/swiper/js/swiper.min.js"></script>
    <script src="../lib/jquery-1.12.4.min.js"></script>
    <script src="../js/details.js"></script>
    

    <script>
        /* 
        2 购物车页面显示加入购物车的商品数量
        接口:'../php/showlist.php'
        */
       $(document).ready(function(){
            $.get('../php/showlist.php', function(data){
                console.log(data);
                var json = JSON.parse(data);
                console.log(json);
                console.log(json.data);

                if(json.code==0){
                
                }else{
                    $res = json.data[0]['product_num'];
                    console.log($res); //5
                    $('.amount').html($res);
                    
                    //数量变化对应的总价变化
                    $originPrice = parseInt($('.originPrice').html());
                    console.log($originPrice)

                    $('.totalPrice').html($originPrice*$res+'.00');

                }
            })
       })
       


       //3 删除购物车里面的指定id的商品
       $('#delItem').click(function(){
            $.get('../php/delwq.php',{
                id:10000
            }, function(data){
                // console.log(data);
                var res = data;
                if(res==1){
                    $('#itemList').html('');
                }
            })
       })


    //4 更新商品数量之增加
        $('.addNum').click(function(){
           //点击：数量增加
            $numO = $('.amount').text()-0;
            $numF = ++$numO;
            $('.amount').html($numF);

           //数量变化对应的总价变化
            $originPrice = parseInt($('.originPrice').html());
            $res=$('.amount').html()-0;

            $('.totalPrice').html($originPrice*$res+'.00');

            //更新数据库
            $.get('../php/update.php',{
               id: 10000,
               type: 'add',
            }, function(data){
            //    console.log(data);
               var json = JSON.parse(data);
                if(json.code==1){
                    alert('商品数量增加成功') 
                }
            })

        })

       //5 更新商品数量之减少
        $('.cutNum').click(function(){

           //数量<=1,禁止，不会再减了
            if($('.amount').html()-0 <= 1){
                $('.cutNum').css({
                    "cursor": "not-allowed"
                });
               return;
            }
            
            //点击: 数量减少
            $numO = $('.amount').text()-0;
            console.log($numO);
            $numF = --$numO;
            $('.amount').text($numF);

            //数量变化对应的总价变化
            $originPrice = parseInt($('.originPrice').html());
            $res=$('.amount').html()-0;

            $('.totalPrice').html($originPrice*$res+'.00');


            if($numF<=0){
                //数量<=0就是想删除商品，调用删除接口
                
            }else{ //否则更新数据库
                $.get('../php/update.php',{
                    id:10000,
                    type: 'cut'
                },function(data){
                    var res = data;
                    if(res){
                        alert('商品数量减少成功')
                    }
                })
            }
        })

    </script>

    </body>
</html>